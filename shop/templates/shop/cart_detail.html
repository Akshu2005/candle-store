{% extends 'shop/base.html' %} {% load static %} {% block title %}Cart —
CandleShop{% endblock %} {% block content %}
<h2>Your Cart</h2>

{% if items %}
<table class="table table-hover align-middle">
  <thead>
    <tr>
      <th>Product</th>
      <th>Qty</th>
      <th>Subtotal</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    {% for it in items %}
    <tr>
      <td>
        <a href="{% url 'product_detail' it.product.slug %}"
          >{{ it.product.name }}</a
        >
      </td>
      <td>
        <form
          class="d-flex"
          method="post"
          action="{% url 'cart_update' it.product.id %}"
        >
          {% csrf_token %}
          <input
            name="quantity"
            type="number"
            value="{{ it.quantity }}"
            min="0"
            class="form-control"
            style="width: 100px"
          />
          <button class="btn btn-sm btn-outline-primary ms-2">Update</button>
        </form>
      </td>
      <td>₹{{ it.subtotal }}</td>
      <td>
        <form method="post" action="{% url 'cart_remove' it.product.id %}">
          {% csrf_token %}<button class="btn btn-sm btn-danger">Remove</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<div class="d-flex justify-content-end align-items-center gap-3">
  <div class="fs-5">Total: <strong>₹{{ total }}</strong></div>
  {% if user.is_authenticated %}
  <a class="btn btn-success btn-lg" href="{% url 'checkout' %}">Checkout</a>
  {% else %}
  <a class="btn btn-primary" href="{% url 'login' %}">Login to Checkout</a>
  {% endif %}
</div>

{% else %}
<p class="text-muted">
  Your cart is empty — find something nice in
  <a href="{% url 'home' %}">shop</a>.
</p>
{% endif %} {% endblock %}
